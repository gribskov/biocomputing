<!DOCTYPE html>
<html>
<head>
    <title>Diagon</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>

<body>
<h1>Diagon</h1>

<div class="controlpanel">

    {% for file in state.seq %}
        {% if file.status == 'next' %}
            {% if loop.index == 2 %}
                <form action="/self" method="POST">
                    <input type="submit" name="selfplot" value="Self plot">
                </form>
            {% endif %}

            <h2>Sequence {{loop.index}}</h2>

            <form action="/getSequence" method="POST"
                  enctype="multipart/form-data"
                  style="margin-top: 10px;">

                FastA formatted sequence: <input type="file" name="file{{loop.index}}"/>
                <br/>
                <input type="submit"  value="Load"/>
            </form>

        {% elif file.status == 'loaded' %}
            <div class="sequence">
                <h2>Sequence {{loop.index}}</h2>
                <h3> {{file.fasta.id}} - {{file.fasta.doc}}</h3>
                <pre>
{{file.fasta.format()}}
                </pre>
            </div>

        {% endif %}
    {% endfor %}
</div>


{% if state.seq.0.status=='loaded' and state.seq.1.status=='loaded' %}
<div class="controlpanel">
    <form action="/dotplot" method="POST" style="margin-top: 10px;">

        {% if state.seqtype == 'DNA' %}
            <input type="radio" name="type" value="forward" checked/> Both sequences in forward orientation<br/>
            <input type="radio" name="type" value="reverse"/> Reverse-complement sequence 2<br/>
            <input type="radio" name="type" value="forward_backward"/> Forward + Backward plot
        {% endif %}

        <h2>Scoring table</h2>

        {% if state.seqtype == 'DNA' %}
            Scoring tables for {{state.seqtype}} sequences<br/>

            {% for table in state.dnacmp %}
                <input type="radio" name="cmp" value="{{table.loc}}"
                       {% if loop.index0 == 0 %} checked {% endif %} > {{table.name}}<br/>
            {% endfor %}
        {% elif state.seqtype == 'protein' %}
            Scoring tables for {{state['seqtype']}} sequences<br/>

            {% for table in state.procmp %}
                <input type="radio" name="cmp" value="{{table.loc}}"
                       {% if loop.index0 == 0 %} checked {% endif %} > {{table.name}}<br/>
            {% endfor %}
        {% endif %}
        <br/>
        <h2>Plot parameters</h2>
        <input type="text"  size=4 id="window" name="window"
                             pattern="\d*" min="1" value=10> Window length <br/>
        <input type="text"   size=4 id="threshold" name="threshold"
                         value=8> Threshold <br/><br/>
        Mode <br/>
        <input type="radio" name="mode" value='dot' checked> Display matching windows as dots<br/>
        <input type="radio" name="mode" value='line'> Display matching windows as lines<br/><br/>

        <input type="submit"  value="Plot"/>&nbsp;<button type="submit" formaction="/dashboard">Reset</button><br/><br/>

        <a name="advanced"></a>
            {% if state.params.advanced %}

            <h3> Advanced graphics parameters</h3>
            <input type="submit" formaction={{url_for("advanced", _anchor="advanced")}} value="Hide"> advanced parameters<br/><br/>
            <input type="radio" name="width" value=True checked> Use size-based score cueing<br/>
            <input type="radio" name="width" value=False> Do not use size-based score cueing<br/><br/>

            <input type="text"  size=1 id="mindotsize" name="mindotsize"
                                 pattern="\d*" min="1" value=2> Minimum dot/line size (px) <br/>
            <input type="text"  size=1 id="maxdotsize" name="maxdotsize"
                                 pattern="\d*" min="1" value=8> Maximum dot/line size (px) <br/><br/>

            <input type="radio" name="color" value=True checked> Use color-based score cueing<br/>
            <input type="radio" name="color" value=False> Do not use color-based score cueing<br/><br/>
        {% else %}
            <input type="submit" formaction={{url_for("advanced", _anchor="advanced")}} value="Show"> advanced plotting parameters
        {% endif %}

    </form>
</div>

{% endif %}


</body>
</html>